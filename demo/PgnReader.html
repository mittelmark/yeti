<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>PgnReader documentation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../pandoc/mini.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">PgnReader documentation</h1>
</header>
<h1 id="pgnreader-0.1---read-chess-pgn-files">PgnReader 0.1 - read chess pgn files</h1>
<h2 id="name">Name</h2>
<p>PgnReader - read chess pgn files.</p>
<h2 id="table-of-contents"><a name='toc'></a>Table Of Contents</h2>
<ul>
<li><a href="#toc">Table Of Contents</a></li>
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#command">Class Command</a></li>
<li><a href="#commands">PgnReader Commands</a></li>
<li><a href="#todo">Todo’s</a></li>
<li><a href="#bugs">Bugs, Ideas, Feedback</a></li>
<li><a href="#authors">Authors</a></li>
<li><a href="#copyright">Copyright</a></li>
</ul>
<h2 id="synopsis"><a name='synopsis'></a>Synopsis</h2>
<pre><code>package require PgnReader 0.1
set scanner [PgnReader #auto]
set pgn [$scanner getGame sample.pgn 4]
puts $pgn
$scanner scanPGNText $pgn
puts [$scanner moves]
puts [$scanner header White]
puts [$scanner header Black]</code></pre>
<h2 id="class-command"><a name='command'></a> Class Command</h2>
<p><strong>PgnReader</strong> <em>cmdname ?options?</em></p>
<p>Create a new PgnReader object with the given options.</p>
<h2 id="class-methods"><a name='commands'></a> Class Methods</h2>
<p><em>cmdName</em> <strong>comment</strong> <em>number</em> <em>?color?</em></p>
<blockquote>
<p>Return a comment for a given move and turn color. Color can be on of <em>b,</em>, <em>black</em>, <em>Black</em>, <em>w</em>, <em>white</em>, <em>White</em> only the first letter is important. If the color is not given move is assumed to be a halfmove.</p>
</blockquote>
<p><em>cmdName</em> <strong>comments</strong></p>
<blockquote>
<p>return all comments for the scanned game.</p>
</blockquote>
<p><em>cmdName</em> <strong>getGame</strong> <em>filename</em> <em>gameNumber</em></p>
<blockquote>
<p><em>filename</em> PGN filename</p>
</blockquote>
<blockquote>
<p><em>gameNumber</em> number of the game, first game is 1</p>
</blockquote>
<blockquote>
<p>returns: PGN code for the game</p>
</blockquote>
<p><em>cmdName</em> <strong>header</strong> <em>key</em></p>
<blockquote>
<p>return the given header entry for key. If no such entry exists returns *</p>
</blockquote>
<p><em>cmdName</em> <strong>move</strong> <em>number</em> <em>?color?</em></p>
<blockquote>
<p>Return for the given move number and turn color. Color can be on of <em>b,</em>, <em>black</em>, <em>Black</em>, <em>w</em>, <em>white</em>, <em>White</em> only the first letter is important. If the color is not given move is assumed to be a halfmove.</p>
</blockquote>
<p><em>cmdName</em> <strong>moves</strong></p>
<blockquote>
<p>return all moves for the scanned game.</p>
</blockquote>
<p><em>cmdName</em> <strong>scanPGNFile</strong> <em>filename</em> <em>gameNumber</em></p>
<blockquote>
<p><em>filename</em> PGN filename</p>
</blockquote>
<blockquote>
<p><em>gameNumber</em> number of the game, first game is 1, defaults to 1</p>
</blockquote>
<blockquote>
<p>returns: number of half moves for scanned game.</p>
</blockquote>
<p><em>cmdName</em> <strong>scanPGNText</strong> <em>pgntext</em></p>
<blockquote>
<p><em>pgntext</em> PGN text string for single game</p>
</blockquote>
<blockquote>
<p>returns: number of half moves for scanned game.</p>
</blockquote>
<h2 id="example">EXAMPLE</h2>
<p>Let’s first demonstrate the retrieval of a specific game from a PGN file:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">source</span> <span class="kw">[file</span> <span class="kw">join</span> <span class="kw">[file</span> <span class="ot">dirname</span> <span class="kw">[info</span> <span class="ot">script</span><span class="kw">]]</span> PgnReader<span class="dv">-0</span>.<span class="fl">1.</span>tm<span class="kw">]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">set</span> pgnfile <span class="kw">[file</span> <span class="kw">join</span> <span class="kw">[file</span> <span class="ot">dirname</span> <span class="kw">[info</span> <span class="ot">script</span><span class="kw">]]</span> sample.pgn<span class="kw">]</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="kw">set</span> scanner <span class="kw">[</span>PgnReader #auto<span class="kw">]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="kw">set</span> pgn <span class="kw">[</span><span class="dt">$scanner</span> getGame <span class="dt">$pgnfile</span> <span class="dv">4</span><span class="kw">]</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">puts</span> <span class="dt">$pgn</span></span></code></pre></div>
<pre class="tclout"><code>[Event &quot;Anand - Carlsen World Championship Match&quot;]
[Site &quot;Chennai IND&quot;]
[Date &quot;2013.11.16&quot;]
[Round &quot;6&quot;]
[White &quot;Viswanathan Anand&quot;]
[Black &quot;Magnus Carlsen&quot;]
[Result &quot;0-1&quot;]
[EventDate &quot;2013.11.07&quot;]
[ECO &quot;C65&quot;]
[WhiteElo &quot;?&quot;]
[BlackElo &quot;?&quot;]
[PlyCount &quot;134&quot;]

1. e4 e5 2. Nf3 Nc6 3. Bb5 Nf6 4. d3 Bc5 5. c3 O-O 6. O-O Re8 7. Re1 a6 8. Ba4
b5 9. Bb3 d6 10. Bg5 Be6 11. Nbd2 h6 12. Bh4 Bxb3 13. axb3 Nb8 14. h3 Nbd7 15.
Nh2 Qe7 16. Ndf1 Bb6 17. Ne3 Qe6 18. b4 a5 19. bxa5 Bxa5 20. Nhg4 Bb6 21. Bxf6
Nxf6 22. Nxf6+ Qxf6 23. Qg4 Bxe3 24. fxe3 Qe7 25. Rf1 c5 26. Kh2 c4 27. d4 Rxa1
28. Rxa1 Qb7 29. Rd1 Qc6 30. Qf5 exd4 31. Rxd4 Re5 32. Qf3 Qc7 33. Kh1 Qe7 34.
Qg4 Kh7 35. Qf4 g6 36. Kh2 Kg7 37. Qf3 Re6 38. Qg3? Rxe4 39. Qxd6 Rxe3 40. Qxe7
Rxe7 41. Rd5 Rb7 42. Rd6 f6 43. h4 Kf7 44. h5 gxh5 45. Rd5 Kg6 46. Kg3 Rb6 47.
Rc5 f5 48. Kh4 Re6 49. Rxb5 Re4+ 50. Kh3 Kg5 51. Rb8 h4 52. Rg8+ Kh5 53. Rf8 Rf4
54. Rc8 Rg4 55. Rf8 Rg3+ 56. Kh2 Kg5 57. Rg8+ Kf4 58. Rc8 Ke3 59. Rxc4 f4 60.
Ra4 h3 61. gxh3 Rg6 62. c4 f3 63. Ra3+ Ke2 64. b4 f2 65. Ra2+ Kf3 66. Ra3+ Kf4
67. Ra8 Rg1 0-1


</code></pre>
<p>The real scanner works on single games. It is executed on the PGN text using the method <em>scanPGNText</em>. Let’s display the moves and who is white and black:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="dt">$scanner</span> scanPGNText <span class="dt">$pgn</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> moves<span class="kw">]</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header White<span class="kw">]</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header Black<span class="kw">]</span></span></code></pre></div>
<pre class="tclout"><code>e4 e5 Nf3 Nc6 Bb5 Nf6 d3 Bc5 c3 O-O O-O Re8 Re1 a6 Ba4 b5 Bb3 d6 Bg5 Be6 Nbd2 h6 Bh4 Bxb3 axb3 Nb8 h3 Nbd7 Nh2 Qe7 Ndf1 Bb6 Ne3 Qe6 b4 a5 bxa5 Bxa5 Nhg4 Bb6 Bxf6 Nxf6 Nxf6+ Qxf6 Qg4 Bxe3 fxe3 Qe7 Rf1 c5 Kh2 c4 d4 Rxa1 Rxa1 Qb7 Rd1 Qc6 Qf5 exd4 Rxd4 Re5 Qf3 Qc7 Kh1 Qe7 Qg4 Kh7 Qf4 g6 Kh2 Kg7 Qf3 Re6 Qg3 Rxe4 Qxd6 Rxe3 Qxe7 Rxe7 Rd5 Rb7 Rd6 f6 h4 Kf7 h5 gxh5 Rd5 Kg6 Kg3 Rb6 Rc5 f5 Kh4 Re6 Rxb5 Re4+ Kh3 Kg5 Rb8 h4 Rg8+ Kh5 Rf8 Rf4 Rc8 Rg4 Rf8 Rg3+ Kh2 Kg5 Rg8+ Kf4 Rc8 Ke3 Rxc4 f4 Ra4 h3 gxh3 Rg6 c4 f3 Ra3+ Ke2 b4 f2 Ra2+ Kf3 Ra3+ Kf4 Ra8 Rg1
Viswanathan Anand
Magnus Carlsen
</code></pre>
<p>As an alternative to the start and run cycle you can as well use the <code>scanPGNText</code> method, see below. What was the second move of black?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> <span class="ot">move</span> <span class="dv">1</span> White<span class="kw">]</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> <span class="ot">move</span> <span class="dv">1</span> Black<span class="kw">]</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> <span class="ot">move</span> <span class="dv">2</span> w<span class="kw">]</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> <span class="ot">move</span> <span class="dv">2</span> b<span class="kw">]</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> <span class="ot">move</span> <span class="dv">3</span> w<span class="kw">]</span></span></code></pre></div>
<pre class="tclout"><code>e4
e5
Nf3
Nc6
Bb5
</code></pre>
<p>Let’s now load an another game, there is scan:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">set</span> pgn <span class="kw">[</span><span class="dt">$scanner</span> getGame sample.pgn <span class="dv">1</span><span class="kw">]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="dt">$scanner</span> scanPGNText <span class="dt">$pgn</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header White<span class="kw">]</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header Black<span class="kw">]</span></span></code></pre></div>
<pre class="tclout"><code>Teimour Radjabov
Magnus Carlsen
</code></pre>
<p>Other meta information about the currently scanned PGN game can can be as well retrieved via the <em>header</em> method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header Date<span class="kw">]</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="kw">puts</span> <span class="kw">[</span><span class="dt">$scanner</span> header Result<span class="kw">]</span></span></code></pre></div>
<pre class="tclout"><code>2013.03.31
0-1
</code></pre>
<h2 id="session">SESSION</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">puts</span> <span class="st">&quot;Tcl: [package present Tcl]&quot;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">puts</span> <span class="st">&quot;Itcl: [package versions Itcl]&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="kw">puts</span> <span class="st">&quot;tcl++: [package versions tcl++]&quot;</span></span></code></pre></div>
<pre class="tclout"><code>Tcl: 8.6.10
Itcl: 4.1.1
tcl++: 
</code></pre>
<h2 id="installation">INSTALLATION</h2>
<ul>
<li>You need the yeti package to create the Scanner.</li>
<li>You need the package Itcl or it’s replacement tcl++ to run the generated scanner. A minmal version of the tcl++ package which is largely compatible with Itcl 3.0 can be retrieved from:</li>
</ul>
</body>
</html>
